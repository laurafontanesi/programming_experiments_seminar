---
title: "Events in a trial"
---

In last week's task the trial structure was relatively simple: Participants were shown a text stimulus and were asked to choose between two gambles. The gambles were described a unique text that was shown in the middle of the screen. We later added a text to remind participants of which keys they could press to express their choice, as well as a "Get ready" text at the beginning of each trial.

Today we explore slightly more complex trial structures.

## 1) Feedbacks

One of the most common thing we might want to add is a feedback after each choice. Feedbacks are quite common both in perceptual and more value-based decision tasks.

For this purpose, we are going to use the stimuli for a categorization task, taken from [Spiering & Ashby (2008)](https://doi.org/10.1111/j.1467-9280.2008.02219.x). You can download them from using this [Dropbox link](https://www.dropbox.com/sh/6fa8w54tz9eib5z/AACxvu6hs6cLNL8fAgo91gZNa?dl=0).

```{r echo=FALSE, out.width = "50%", fig.align = "center"}
knitr::include_graphics("wpa4_categories.png")
```

In this task, participants learn to categorize these 30 patches (visual stimuli that vary across trials in bar width and bar orientation) into 2 categories, A and B (the boundaries of which are denoted by the thick line in the figure), by trial and error. The feedback of "correct" and "incorrect" is provided after each choice and guides learning in the subsequent trials.

### A new script

Create a new Inquisit script file and named it `wpa_4_FirstLast.iqx` (with your First and Last name). This is the file you will email to me at the end of the class.

Now that you have a script file, define some defaults settings at the beginning of the file (as we did in [WPA 3](https://laurafontanesi.github.io/programming_experiments_seminar/wpa3.html)).

### Define the choice stimuli

Just like we used the `item` element to define our text strings last week, we can use the `item` element this week to load our image files. The way we do this is by specifying the filepath for each image, where we specified the text string last week. This filepath is **from the location your Inquisit script is saved in**. So if your image files are saved in the same location as your `.iqx` file, you just have to give the file name. For example:

```
<item example>  
/1="patch1.png" 
/2="patch2.png" 
</item>
```

Last week we also mentioned how to [load stimuli lists from file](https://www.millisecond.com/forums/Topic19045.aspx). I prepared a stimulus list text file in the folder, in case you'd like to try that out (otherwise, you can simply copy-paste the code in Inquisit...).

Last week we had a single item element. Now we have two categories of stimuli, category A and category B. In our design we need to be able to provide feedback to participants on whether they were correct or not during the training phase of the Expeiment. This means that we need to be able to tell Iquisit which category each item is in, that it can provide the appropriate feedback based on the participants response. This requires seperate stimuli lists for A and B items.

**Exercise 1a**: Try to create your stimuli lists. Give each list an informative name (e.g., `stimlistA` and `stimlistB`).

Just like with the text elements, now that we have defined our stimuli, we need to specify how they should look when displayed on the screen. Because our stimuli are pcitures, not text, we can do this by defining a `picture` element. This element has an `items` attribute and a `select` attribute, just like the `text` element, as well as attributes for defining location, size etc. 

**Exercise 1b**: Based on your `text` code from last week, create the appropriate `picture` elements, so that the stimuli as displayed in the center of the screen (Use the help function if you want a reminder on wha the position, items and select attributes do). You can also change other attributes of the images being displayed. I recommend changing the size of the image as well.

NOTE: We need as many picture elements as we have item elements, even though all pictures will be displayed in the same way. This is because trial calls stimulus level (i.e. picture, text etc) elements, not item level elements.

### Define the Trials

**Exercise 1c**: Create a trial element for each of our stimuli types, similar to the ones from last week. The valid responses for all elements should be `a` and `b`. 

In the paper there is a break of 1500ms between each trial. Build this into your trial elements. Last week we controlled how much time there was between each trial by using the `stimulustimes` attribute of the trial element. This is useful if we want to display something during that time (for exampe a warning to get ready, or a fixation cross). However, we can also explicitly tell Inquisit to pause between trials, using either the `pretrialpause` attribute or the `posttrialpause` attribute. The first of these prepares the trial, but then waits the designated time before beginning it. This can be advantageous if it takes Inquisit some time to prepare the next trial (e.g., it has to load large stimuli, or do calculations), because it insures that their is a consistent time gap between trials. 

**Exercise 1d**: Try setting the pause between trials of 1500 ms using `pretrialpause`.

Now we have to tell Inquisit what counts as the correct response on each trial.

**Exercise 1e**: Look at the help file for the trial element, and see if you can work out how to set the correct response for each trial type.

Inquisit can display information that is dependent on participants' choices in several ways. The simplest is to display a message based on the response they gave. There are 3 main message attributes, `correctmessage`, `errormessage` and `responsemessage`. We will use the first 2. Each of these takes two pieces of information, the name of the stimulus that is displayed as the message, and the length of time for which it should be displayed.

This means we need to create some stimuli for Inquisit to display. We'll just create text stimuli for both messages. When they get a category right, I want to display the word **Correct!** in large font coloured blue, when they get the category wrong, it should display **Incorrect!** in red instead.

**Exercise 1f**: Create the `text` elements to do this. Then, use the `correctmessage` and `errormessage` attributes to tell each trial how to use these two `text` stimuli. You'll need to do this for each trial type.

### Define the Block and Experiment

For simplicity, we will just have 1 block of 30 trials, where we randomize the category A and B stimuli.

**Exercise 1g**: Create 1 block and 1 experiment elements. To find out how to randomly select from 2 trial types, check the examples in th Inquisit help page for the block element.

### Testing the code

Congratulations, you should now have a working Experiment. Try it out before you attempt the rest of the Exercises.

### Final message

Now that you have a working experiment and you have gone through it once, you can check the data output. You should see a `correct` column, which is 0 when the response was incorrect and 1 when the response was correct.

We now want to summarize participants' performance and show it at the end of the experiment in a text message.

For this purpose, we need to introduce the `values` element, which contains custom variables that can be retrieved and updated throughout the course of a script.

**Exercise 1h**: Create a variable inside the values element, call it `accuracy` and set it at an initial value of 50.

Now we need to update such variable after each trial, to reflect the performance up to that point. First, the trial element has 2 attributes called `ontrialend` and `ontrialbegin`, inside which we can specify operations that we want to be performed before or after each trial. In this case, we will use the `ontrialend` attribute alone. Second, each trial object already has a few values attached to it that can be "called".

**Exercise 1i**: Within the squared brackets of the `ontrialend` attribute of trial A, type the label of that trial, followed by a dot, and press the tab key. You should be able to see now all the values that are attached to that object. Look for one that represents the percentage of correct responses and press enter. Now, within the squared brackets, redefine the accuracy variable to this value (to assign a value to a variable, use the notation: `variable = value`). Do the same separately for the 2 trial types, making sure you use the correct label.

Finally, we need to create a page, using the `page` element, that 

## 2) Conditional branching [to do next time]

## Send me your assignments

You can send your assignment to my email address: laura.fontanesi@unibas.ch. 

For this assignment, please send me the Inquisit script. If you want to add comments, you can do that by adding the hashtag `#` at the beginning of the line.